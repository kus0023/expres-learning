<link rel="stylesheet" href="/css/home.css">

<section id="home-main" class="container">

  <!-- Form will only be visible to authenticated user, Although one check needed at router level as well -->
  <% if(locals.user) {%>
    <section id="post-feed" class="mt-4 sticky-lg-top">
      <div class="card">
        <h5 class="card-header">Have something in Mind?</h5>
        <div class="card-body">
          <!-- <p class="card-text">Let your friends know what you have done today!</p> -->
          <form action="/posts/create" method="POST">
            <div class="mb-3">
              <label for="message-text" class="col-form-label"></label>
              <textarea name="content" class="form-control" id="message-text" rows="3"
                placeholder="Write here ..."></textarea>
            </div>

            <button type="submit" class="btn btn-primary">Post</button>
          </form>
        </div>
      </div>
    </section>
  <% } %>

  <section id="posts-list" class="mt-4 text-start">

    <% for(post of posts) {%>
      <div class="card mt-4">
        <div class="card-header">
          <h5><%= post.user.name %></h5><span class="text-muted"><%= post.createdAt %></span>
        </div>
        <div class="card-body">
          <blockquote class="blockquote mb-0">
            <p><%= post.content %></p>
          </blockquote>
        </div>

        <!-- Collapsed component used for comment form -->
        <div class="container">
          <div class="card-footer row comment-btn-no-outline" >
            <button type="button" class="btn btn-light btn-lg col-4"><span class="badge bg-success">4</span> Like </button>
            <button type="button" class="btn btn-light btn-lg col-4" data-bs-toggle="collapse" data-bs-target="#<%= 'read_'+post.id%>" 
            aria-expanded="false" aria-controls="<%= 'read_'+post.id%>"><span class="badge bg-warning">3</span> Comments</button>
            <button type="button" class="btn btn-light btn-lg col-4" data-bs-toggle="collapse" data-bs-target="#<%= 'post_'+post.id%>" 
              aria-expanded="false" aria-controls="<%= 'post_'+post.id%>">Reply</button>
          </div>
        </div>

        <!-- -------------------------------------------------Comment section---------------------------------------------------------- -->

        <!-- If user is not logged in then he will not be able to comment on Post. -->
        <% if(locals.user) {%> 
          <div class="collapse" id="<%= 'post_'+post.id%>">
            <div class="card card-body">
              <form action="">
                <div class="input-group mb-3">
                    <!-- Hidden Input will be used to send comment for specific post and user -->
                    <input type="hidden" name="post_id" value="<%= post.id %>" >
                    <input type="hidden" name="user_id" value="<%= locals.user.id %>" >
                    <input type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2">
                    <button class="btn btn-outline-secondary" type="submit" id="button-addon2">Comment</button>
                </div>
              </form>
            </div>
          </div>
        <% } else  {%>
          <div class="collapse" id="<%= 'post_'+post.id%>">
            <div class="card card-body text-center">
              Please login to comment <a class="btn btn-danger" href="/users/sign-in">Login</a>
            </div>
          </div>
        <% } %>
        

        <!-- Collapse: List of comments Apears when user click on view comments-->
        <div class="collapse" id="<%= 'read_'+post.id%>"><div class="list-group container text-center">

          <a href="#" class="list-group-item list-group-item-action" aria-current="true">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">List group item heading</h5>
              <small>3 days ago</small>
            </div>
            <p class="mb-1">Some placeholder content in a paragraph.</p>
            <small>And some small print.</small>
          </a>
          <a href="#" class="list-group-item list-group-item-action">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">List group item heading</h5>
              <small class="text-muted">3 days ago</small>
            </div>
            <p class="mb-1">Some placeholder content in a paragraph.</p>
            <small class="text-muted">And some muted small print.</small>
          </a>
          <a href="#" class="list-group-item list-group-item-action">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">List group item heading</h5>
              <small class="text-muted">3 days ago</small>
            </div>
            <p class="mb-1">Some placeholder content in a paragraph.</p>
            <small class="text-muted">And some muted small print.</small>
          </a>
        </div></div>
        
        
      </div>
    <%}%>
  </section>

  <div>
    <div id="carouselExampleCaptions" class="carousel carousel-dark slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"
          aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"
          aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"
          aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img
            src="https://img.freepik.com/free-vector/group-discussion-concept-illustration_114360-8522.jpg?size=626&ext=jpg"
            class="d-block w-100 h-50" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>First slide label</h5>
            <p>Some representative placeholder content for the first slide.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://img.freepik.com/premium-vector/relationships-illustration_732093-139.jpg?size=626&ext=jpg"
            class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>Second slide label</h5>
            <p>Some representative placeholder content for the second slide.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img
            src="https://img.freepik.com/free-vector/social-media-marketing-mobile-phone-concept_23-2148423800.jpg?size=626&ext=jpg&ga=GA1.2.922780510.1688816352&semt=ais"
            class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>Third slide label</h5>
            <p>Some representative placeholder content for the third slide.</p>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>

</section>